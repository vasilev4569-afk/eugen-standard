{{ define "main" }}

  {{/* =========================
     Helpers: language-aware paths
     ========================= */}}
  {{ $lp := .Site.LanguagePrefix }}
  {{ if eq $lp "" }}{{ $lp = "" }}{{ end }}

  {{ $dataRoot := printf "%s/data/" $lp }}
  {{ $catRoot  := printf "%s/data/external-ssd/" $lp }}

  {{/* =========================
     Smart H1 for hierarchy
     - brand page: "Samsung"
     - model page: "Samsung T7"
     ========================= */}}
  {{ $h1 := .Title }}
  {{/* model page = has parent (brand) and parent has parent (category) */}}
  {{ if and .Parent .Parent.Parent }}
    {{ if eq .Parent.Parent.RelPermalink $catRoot }}
      {{ $h1 = printf "%s %s" .Parent.Title .Title }}
    {{ end }}
  {{ end }}
  <h1>{{ $h1 }}</h1>

  {{ if .Content }}<div>{{ .Content }}</div>{{ end }}

  {{ $sections := .Sections }}
  {{ $pages := .RegularPages }}

  {{/* =========================
     Brand page detection (language-aware):
     current page parent is the category page /data/external-ssd/
     ========================= */}}
  {{ $isBrandPage := and .Parent (eq .Parent.RelPermalink $catRoot) (ne .RelPermalink $catRoot) }}

  {{ if or (gt (len $sections) 0) (gt (len $pages) 0) }}
    <ul>
      {{ range $sections.ByTitle }}
        <li>
          <a href="{{ .RelPermalink }}">
            {{- if $isBrandPage -}}
              {{ $.Title }} {{ .Title }}
            {{- else -}}
              {{ .Title }}
            {{- end -}}
          </a>
        </li>
      {{ end }}

{{ range $pages.ByTitle }}
  <li>
    <a href="{{ .RelPermalink }}">
      {{- with .Params.capacity_label -}}
        {{ printf "%s %s" $h1 . }}
      {{- else -}}
        {{ .Title }}
      {{- end -}}
    </a>
  </li>
{{ end }}
    </ul>
  {{ else }}
    <p>No items yet.</p>
  {{ end }}

{{ end }}
