{{ define "main" }}

  {{/* =========================
     Language-aware paths
     ========================= */}}
  {{ $lp := .Site.LanguagePrefix }}
  {{ if eq $lp "" }}{{ $lp = "" }}{{ end }}

  {{ $catRoot  := printf "%s/data/external-ssd/" $lp }}

  {{/* =========================
     Clean H1
     - category: "External SSDs"
     - brand: "Samsung"
     - model: "Samsung T7"
     Uses .Params.titleKey if present (i18n), else .Title
     ========================= */}}
  {{ $tkey := .Params.titleKey }}
  <h1>
    {{- if $tkey -}}
      {{ i18n $tkey }}
    {{- else -}}
      {{ .Title }}
    {{- end -}}
  </h1>

  {{ if .Content }}
    <div>{{ .Content }}</div>
  {{ end }}

  {{ $sections := .Sections }}
  {{ $pages := .RegularPages }}

  {{ if or (gt (len $sections) 0) (gt (len $pages) 0) }}
    <ul>

      {{/* =========================
         Subsections (brands, models)
         ========================= */}}
      {{ range $sections.ByTitle }}
        <li>
          <a href="{{ .RelPermalink }}">
            {{- $sk := .Params.titleKey -}}
            {{- if $sk -}}
              {{ i18n $sk }}
            {{- else -}}
              {{ .Title }}
            {{- end -}}
          </a>
        </li>
      {{ end }}

      {{/* =========================
         Leaf pages (capacities)
         ========================= */}}
      {{ range $pages.ByTitle }}
        <li>
          <a href="{{ .RelPermalink }}">
            {{ with .Params.capacity_label }}
              {{ printf "%s %s" $.Title . }}
            {{ else }}
              {{ .Title }}
            {{ end }}
          </a>
        </li>
      {{ end }}

    </ul>
  {{ else }}
    <p>No items yet.</p>
  {{ end }}

{{ end }}