{{ define "main" }}
<main class="container">
  <article>
    <header>
      <h1>{{ .Title }}</h1>

      {{/* Capacity switcher */}}
      {{- $path := .RelPermalink -}}
      {{- $isCapPage := or (strings.HasSuffix $path "/500gb/") (strings.HasSuffix $path "/1tb/") (strings.HasSuffix $path "/2tb/") -}}
      {{- if $isCapPage -}}
        {{- $base := $path | replaceRE "/(500gb|1tb|2tb)/$" "/" -}}
        <nav class="cap-switch" aria-label="Capacity switch">
          <a class="cap-btn {{ if strings.HasSuffix $path "/500gb/" }}is-active{{ end }}" href="{{ $base }}500gb/">500GB</a>
          <a class="cap-btn {{ if strings.HasSuffix $path "/1tb/" }}is-active{{ end }}" href="{{ $base }}1tb/">1TB</a>
          <a class="cap-btn {{ if strings.HasSuffix $path "/2tb/" }}is-active{{ end }}" href="{{ $base }}2tb/">2TB</a>
        </nav>
      {{- end -}}

      {{/* AUTO IMAGE:
           If page is 1tb.md → try 1tb.jpg/png/webp
      */}}
      {{- $basePath := .File.Dir -}}
      {{- $name := .File.TranslationBaseName -}}

      {{- $jpg := printf "%s%s.jpg" $basePath $name -}}
      {{- $png := printf "%s%s.png" $basePath $name -}}
      {{- $webp := printf "%s%s.webp" $basePath $name -}}

      {{- if fileExists (printf "content/%s%s.jpg" $basePath $name) -}}
        <figure class="unit-photo">
          <img src="{{ printf "%s.jpg" $name | relURL }}" alt="{{ .Title }} – test unit photo" loading="lazy" decoding="async">
        </figure>
      {{- else if fileExists (printf "content/%s%s.png" $basePath $name) -}}
        <figure class="unit-photo">
          <img src="{{ printf "%s.png" $name | relURL }}" alt="{{ .Title }} – test unit photo" loading="lazy" decoding="async">
        </figure>
      {{- else if fileExists (printf "content/%s%s.webp" $basePath $name) -}}
        <figure class="unit-photo">
          <img src="{{ printf "%s.webp" $name | relURL }}" alt="{{ .Title }} – test unit photo" loading="lazy" decoding="async">
        </figure>
      {{- end -}}

      {{ with .Params.description }}
        <p class="lead">{{ . }}</p>
      {{ end }}
    </header>

    <section class="content">
      {{ .Content }}
    </section>

    <footer class="meta">
      {{ with .Lastmod }}
        <p class="small">Last updated: {{ .Format "2006-01-02" }}</p>
      {{ end }}
    </footer>
  </article>
</main>
{{ end }}
