{{ define "main" }}
<main class="container">
  <article>
    <header>
      <h1>{{ .Title }}</h1>

      {{/* Capacity switcher for pages like .../t7/1tb/ */}}
      {{- $path := .RelPermalink -}}
      {{- $isCapPage := or (strings.HasSuffix $path "/500gb/") (strings.HasSuffix $path "/1tb/") (strings.HasSuffix $path "/2tb/") -}}
      {{- if $isCapPage -}}
        {{- $base := $path | replaceRE "/(500gb|1tb|2tb)/$" "/" -}}
        <nav class="cap-switch" aria-label="Capacity switch">
          <a class="cap-btn {{ if strings.HasSuffix $path "/500gb/" }}is-active{{ end }}" href="{{ $base }}500gb/">500GB</a>
          <a class="cap-btn {{ if strings.HasSuffix $path "/1tb/" }}is-active{{ end }}" href="{{ $base }}1tb/">1TB</a>
          <a class="cap-btn {{ if strings.HasSuffix $path "/2tb/" }}is-active{{ end }}" href="{{ $base }}2tb/">2TB</a>
        </nav>
      {{- end -}}

      {{/* ONE photo on top:
           If the page is a bundle and contains ANY image resource,
           show the first one (sorted by name).
      */}}
      {{- $imgs := .Resources.ByType "image" -}}
      {{- if gt (len $imgs) 0 -}}
        {{- $img := index (sort $imgs "Name" "asc") 0 -}}
        <figure class="unit-photo">
          <img
            src="{{ $img.RelPermalink }}"
            alt="{{ .Title }} – test unit photo"
            loading="lazy"
            decoding="async">
        </figure>
      {{- end -}}

      {{ with .Params.description }}
        <p class="lead">{{ . }}</p>
      {{ end }}
    </header>

    <section class="content">
      {{ .Content }}
    </section>

    <footer class="meta">
      {{ with .Lastmod }}
        <p class="small">Last updated: {{ .Format "2006-01-02" }}</p>
      {{ end }}
    </footer>
  </article>
</main>
{{ end }}
